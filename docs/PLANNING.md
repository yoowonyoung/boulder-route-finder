# 📋 볼더링 루트파인더 v1 구현 계획서

**날짜**: 2026-02-10
**상태**: 승인됨 ✅

---

## 🎯 v1 범위

| 기능 | 설명 |
|------|------|
| 이미지 업로드 | 드래그앤드롭 / 파일 선택 |
| 홀드 마킹 UI | 캔버스에 클릭으로 홀드 위치 마킹 (순서 자동 부여) |
| 시작/탑 표시 | 첫 번째 = 시작, 마지막 = 탑 |
| 마킹 수정 | 실행취소, 전체 초기화 |
| **베타 시각화** | 이미지 위에 화살표 + 번호 + 팁 오버레이 |
| 베타 추천 | 마킹된 홀드 기반 등반 시퀀스 생성 (LLM) |

---

## 🏗️ Architecture

```
┌─────────────────────────────────────────┐
│              Frontend                    │
│  ┌─────────────┐  ┌──────────────────┐  │
│  │ ImageUpload │  │  MarkingCanvas   │  │
│  └─────────────┘  │  (마킹 + 오버레이) │  │
│                   └──────────────────┘  │
│  ┌──────────────────────────────────┐   │
│  │       BetaOverlay (시각화)        │   │
│  │  - 번호 원 (①②③)                │   │
│  │  - 화살표 (무브 방향)             │   │
│  │  - 말풍선 (핵심 팁)               │   │
│  │  - ⚠️ 크럭스 표시                │   │
│  └──────────────────────────────────┘   │
└────────────────┬────────────────────────┘
                 │ POST /api/beta
                 ▼
┌─────────────────────────────────────────┐
│              Backend                     │
│  ┌──────────────────────────────────┐   │
│  │  홀드 좌표 분석                   │   │
│  │  - 거리/방향 계산                 │   │
│  │  - 볼더링 지식 프롬프트           │   │
│  │  → LLM API (Claude)              │   │
│  │  → 시각화용 데이터 반환           │   │
│  └──────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

---

## 🔧 기술 스택

| 구분 | 기술 | 이유 |
|------|------|------|
| Frontend | React + TypeScript + Tailwind | 기본 스택 |
| 캔버스 | HTML Canvas API | 이미지 위 마킹 + 오버레이 |
| Backend | Python + FastAPI | LLM 연동 간편 |
| LLM | Claude API | 볼더링 지식 프롬프트 |

---

## 📡 API 설계

### POST /api/beta

**Request:**
```json
{
  "holds": [
    {"x": 320, "y": 1050, "order": 1},
    {"x": 280, "y": 870, "order": 2},
    {"x": 310, "y": 720, "order": 3}
  ],
  "imageWidth": 720,
  "imageHeight": 1280
}
```

**Response (시각화용):**
```json
{
  "moves": [
    {
      "holdIndex": 1,
      "x": 320, "y": 1050,
      "label": "Start",
      "icon": "🚀",
      "shortTip": null,
      "isCrux": false
    },
    {
      "holdIndex": 2,
      "x": 280, "y": 870,
      "label": "2",
      "arrow": {
        "fromX": 320, "fromY": 1050,
        "toX": 280, "toY": 870,
        "direction": "up-left"
      },
      "shortTip": "발 먼저!",
      "isCrux": false
    },
    {
      "holdIndex": 3,
      "x": 310, "y": 720,
      "label": "3",
      "arrow": {
        "fromX": 280, "fromY": 870,
        "toX": 310, "toY": 720,
        "direction": "up-right"
      },
      "shortTip": "힐훅 활용",
      "isCrux": true
    }
  ],
  "summary": {
    "difficulty": "V3-V4 추정",
    "keyPoints": ["3→4 구간이 크럭스", "발 위치가 핵심"],
    "totalMoves": 5
  }
}
```

---

## 🎨 시각화 요소

| 요소 | 표시 | 설명 |
|------|------|------|
| 시작점 | 🚀 + 초록 원 | 첫 홀드 |
| 탑 | 🏁 + 빨간 원 | 마지막 홀드 |
| 일반 홀드 | 번호 원 | ①②③... |
| 무브 방향 | 화살표 | 이전 홀드 → 현재 홀드 |
| 크럭스 | ⚠️ | 어려운 구간 |
| 팁 | 말풍선 | 짧은 조언 (5자 내외) |

---

## 👥 에이전트 할당

| 순서 | 에이전트 | 작업 | 복잡도 |
|------|---------|------|--------|
| 1 | **devops-ops** | Docker, nginx, .env 설정 | Simple |
| 1 | **backend-dev** | FastAPI + Claude API + 볼더링 프롬프트 | Medium |
| 2 | **frontend-dev** | 업로드 + Canvas 마킹 + 베타 오버레이 시각화 | Medium+ |

**병렬 실행:**
- 그룹 1: devops-ops + backend-dev (동시)
- 그룹 2: frontend-dev (API 완료 후)

---

## 📚 볼더링 도메인 지식 (Backend 프롬프트용)

```markdown
## 홀드 타입
- 저그(Jug): 큰 손잡이, 쉬움
- 크림프(Crimp): 작은 홀드, 손가락 끝
- 슬로퍼(Sloper): 경사진 홀드, 마찰력
- 핀치(Pinch): 엄지로 조여서
- 포켓(Pocket): 손가락 1-3개

## 기본 무브
- 정적 무브: 천천히 이동 (거리 가까울 때)
- 다이노(Dyno): 점프 (거리 멀 때)
- 힐훅/토훅: 발 걸기 (안정감)
- 플래깅: 균형용 발 교차
- 드롭니: 무릎 꺾어 무게중심 이동

## 거리별 추천
- < 30cm: 정적 무브
- 30-50cm: 리치 + 바디 텐션
- > 50cm: 다이노 또는 중간 홀드 활용

## 방향별 추천
- 수직 상승: 발 위치 핵심
- 대각선: 몸 회전 활용
- 횡이동: 사이드풀 + 플래깅
```

---

## ⚠️ 위험 요소

| 위험 | 대응 |
|------|------|
| LLM 베타 품질 | 프롬프트 상세화, 예시 포함 |
| 캔버스 모바일 터치 | touch 이벤트 핸들링 |
| 이미지 크기 다양 | 좌표를 비율(%)로 정규화 |
| 오버레이 가독성 | 반투명 배경 + 적절한 폰트 크기 |

---

## ✅ 승인 완료

**승인일**: 2026-02-10
**다음 단계**: Building 시작
